
---
title: "envoy_filter.proto"
weight: 5
---

<!-- Code generated by solo-kit. DO NOT EDIT. -->


### Package: `istio.networking.v1alpha3`  
Copyright 2018 Istio Authors

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.


 
#### Types:


- [EnvoyFilter](#envoyfilter)
- [DeprecatedListenerMatch](#deprecatedlistenermatch)
- [ListenerType](#listenertype)
- [ListenerProtocol](#listenerprotocol)
- [InsertPosition](#insertposition)
- [Index](#index)
- [Filter](#filter)
- [FilterType](#filtertype)
- [ProxyMatch](#proxymatch)
- [ClusterMatch](#clustermatch)
- [RouteConfigurationMatch](#routeconfigurationmatch)
- [RouteMatch](#routematch)
- [Action](#action)
- [VirtualHostMatch](#virtualhostmatch)
- [ListenerMatch](#listenermatch)
- [FilterChainMatch](#filterchainmatch)
- [FilterMatch](#filtermatch)
- [SubFilterMatch](#subfiltermatch)
- [Patch](#patch)
- [Operation](#operation)
- [EnvoyConfigObjectMatch](#envoyconfigobjectmatch)
- [EnvoyConfigObjectPatch](#envoyconfigobjectpatch)
- [ApplyTo](#applyto)
- [PatchContext](#patchcontext)
  



##### Source File: `istio.io/api/networking/v1alpha3/envoy_filter.proto`





---
### EnvoyFilter

 
EnvoyFilter provides a mechanism to customize the Envoy configuration
generated by Istio Pilot.

<!-- go code generation tags
+kubetype-gen
+kubetype-gen:groupVersion=networking.istio.io/v1alpha3
+genclient
+k8s:deepcopy-gen=true
-->

```yaml
"workloadLabels": map<string, string>
"filters": []istio.networking.v1alpha3.EnvoyFilter.Filter
"workloadSelector": .istio.networking.v1alpha3.WorkloadSelector
"configPatches": []istio.networking.v1alpha3.EnvoyFilter.EnvoyConfigObjectPatch

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `workloadLabels` | `map<string, string>` | Deprecated. Use workload_selector instead. $hide_from_docs. |  |
| `filters` | [[]istio.networking.v1alpha3.EnvoyFilter.Filter](../envoy_filter.proto.sk/#filter) | $hide_from_docs. |  |
| `workloadSelector` | [.istio.networking.v1alpha3.WorkloadSelector](../sidecar.proto.sk/#workloadselector) | Criteria used to select the specific set of pods/VMs on which this patch configuration should be applied. If omitted, the set of patches in this configuration will be applied to all workload instances in the same namespace. If omitted, the EnvoyFilter patches will be applied to all workloads in the same namespace. If the EnvoyFilter is present in the config root namespace, it will be applied to all applicable workloads in any namespace. |  |
| `configPatches` | [[]istio.networking.v1alpha3.EnvoyFilter.EnvoyConfigObjectPatch](../envoy_filter.proto.sk/#envoyconfigobjectpatch) | One or more patches with match conditions. |  |




---
### DeprecatedListenerMatch

 
Deprecated.
Select a listener to add the filter to based on the match conditions.
All conditions specified in the ListenerMatch must be met for the filter
to be applied to a listener.
$hide_from_docs

```yaml
"portNumber": int
"portNamePrefix": string
"listenerType": .istio.networking.v1alpha3.EnvoyFilter.DeprecatedListenerMatch.ListenerType
"listenerProtocol": .istio.networking.v1alpha3.EnvoyFilter.DeprecatedListenerMatch.ListenerProtocol
"address": []string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `portNumber` | `int` | The service port/gateway port to which traffic is being sent/received. If not specified, matches all listeners. Even though inbound listeners are generated for the instance/pod ports, only service ports should be used to match listeners. |  |
| `portNamePrefix` | `string` | Instead of using specific port numbers, a set of ports matching a given port name prefix can be selected. E.g., "mongo" selects ports named mongo-port, mongo, mongoDB, MONGO, etc. Matching is case insensitive. |  |
| `listenerType` | [.istio.networking.v1alpha3.EnvoyFilter.DeprecatedListenerMatch.ListenerType](../envoy_filter.proto.sk/#listenertype) | Inbound vs outbound sidecar listener or gateway listener. If not specified, matches all listeners. |  |
| `listenerProtocol` | [.istio.networking.v1alpha3.EnvoyFilter.DeprecatedListenerMatch.ListenerProtocol](../envoy_filter.proto.sk/#listenerprotocol) | Selects a class of listeners for the same protocol. Use the protocol selection to select all HTTP listeners (includes HTTP2/gRPC/HTTPS where Envoy terminates TLS) or all TCP listeners (includes HTTPS passthrough using SNI). When adding a HTTP filter, the listenerProtocol should be set to HTTP. |  |
| `address` | `[]string` | One or more IP addresses to which the listener is bound. If specified, should match at least one address in the list. |  |




---
### ListenerType



| Name | Description |
| ----- | ----------- | 
| `ANY` | All listeners |
| `SIDECAR_INBOUND` | Inbound listener in sidecar |
| `SIDECAR_OUTBOUND` | Outbound listener in sidecar |
| `GATEWAY` | Gateway listener |




---
### ListenerProtocol



| Name | Description |
| ----- | ----------- | 
| `ALL` | All protocols |
| `HTTP` | HTTP or HTTPS (with termination) / HTTP2/gRPC |
| `TCP` | Any non-HTTP listener |




---
### InsertPosition

 
Deprecated.
Indicates the relative index in the filter chain where the filter should be inserted.
$hide_from_docs

```yaml
"index": .istio.networking.v1alpha3.EnvoyFilter.InsertPosition.Index
"relativeTo": string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `index` | [.istio.networking.v1alpha3.EnvoyFilter.InsertPosition.Index](../envoy_filter.proto.sk/#index) | Position of this filter in the filter chain. |  |
| `relativeTo` | `string` | If BEFORE or AFTER position is specified, specify the name of the filter relative to which this filter should be inserted. |  |




---
### Index

 
Index/position in the filter chain.

| Name | Description |
| ----- | ----------- | 
| `FIRST` | Insert first |
| `LAST` | Insert last |
| `BEFORE` | Insert before the named filter. |
| `AFTER` | Insert after the named filter. |




---
### Filter

 
Deprecated.
Envoy filters to be added to a network or http filter chain.
$hide_from_docs

```yaml
"listenerMatch": .istio.networking.v1alpha3.EnvoyFilter.DeprecatedListenerMatch
"insertPosition": .istio.networking.v1alpha3.EnvoyFilter.InsertPosition
"filterType": .istio.networking.v1alpha3.EnvoyFilter.Filter.FilterType
"filterName": string
"filterConfig": .google.protobuf.Struct

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `listenerMatch` | [.istio.networking.v1alpha3.EnvoyFilter.DeprecatedListenerMatch](../envoy_filter.proto.sk/#deprecatedlistenermatch) | Filter will be added to the listener only if the match conditions are true. If not specified, the filters will be applied to all listeners where possible, potentially resulting in invalid configurations. It is recommended to specify the listener match criteria for all filter insertions. |  |
| `insertPosition` | [.istio.networking.v1alpha3.EnvoyFilter.InsertPosition](../envoy_filter.proto.sk/#insertposition) | Insert position in the filter chain. Defaults to FIRST. |  |
| `filterType` | [.istio.networking.v1alpha3.EnvoyFilter.Filter.FilterType](../envoy_filter.proto.sk/#filtertype) | The type of filter to instantiate. |  |
| `filterName` | `string` | The name of the filter to instantiate. The name must match a supported filter _compiled into_ Envoy. |  |
| `filterConfig` | [.google.protobuf.Struct](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/struct) | Filter specific configuration which depends on the filter being instantiated. |  |




---
### FilterType



| Name | Description |
| ----- | ----------- | 
| `INVALID` | placeholder |
| `HTTP` | Http filter |
| `NETWORK` | Network filter |




---
### ProxyMatch

 
One or more properties of the proxy to match on.

```yaml
"proxyVersion": string
"metadata": map<string, string>

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `proxyVersion` | `string` | A regular expression in golang regex format (RE2) that can be used to select proxies using a specific version of istio proxy. The Istio version for a given proxy is obtained from the node metadata field ISTIO_VERSION supplied by the proxy when connecting to Pilot. This value is embedded as an environment variable (ISTIO_META_ISTIO_VERSION) in the Istio proxy docker image. Custom proxy implementations should provide this metadata variable to take advantage of the Istio version check option. |  |
| `metadata` | `map<string, string>` | Match on the node metadata supplied by a proxy when connecting to Istio Pilot. Note that while Envoy's node metadata is of type Struct, only string key-value pairs are processed by Pilot. All keys specified in the metadata must match with exact values. The match will fail if any of the specified keys are absent or the values fail to match. |  |




---
### ClusterMatch

 
Conditions specified in ClusterMatch must be met for the patch
to be applied to a cluster.

```yaml
"portNumber": int
"service": string
"subset": string
"name": string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `portNumber` | `int` | The service port for which this cluster was generated. If omitted, applies to clusters for any port. |  |
| `service` | `string` | The fully qualified service name for this cluster. If omitted, applies to clusters for any service. For services defined through service entries, the service name is same as the hosts defined in the service entry. |  |
| `subset` | `string` | The subset associated with the service. If omitted, applies to clusters for any subset of a service. |  |
| `name` | `string` | The exact name of the cluster to match. To match a specific cluster by name, such as the internally generated "Passthrough" cluster, leave all fields in clusterMatch empty, except the name. |  |




---
### RouteConfigurationMatch

 
Conditions specified in RouteConfigurationMatch must be met for
the patch to be applied to a route configuration object or a
specific virtual host within the route configuration.

```yaml
"portNumber": int
"portName": string
"gateway": string
"vhost": .istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch.VirtualHostMatch
"name": string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `portNumber` | `int` | The service port number or gateway server port number for which this route configuration was generated. If omitted, applies to route configurations for all ports. |  |
| `portName` | `string` | Applicable only for GATEWAY context. The gateway server port name for which this route configuration was generated. |  |
| `gateway` | `string` | The Istio gateway config's namespace/name for which this route configuration was generated. Applies only if the context is GATEWAY. Should be in the namespace/name format. Use this field in conjunction with the portNumber and portName to accurately select the Envoy route configuration for a specific HTTPS server within a gateway config object. |  |
| `vhost` | [.istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch.VirtualHostMatch](../envoy_filter.proto.sk/#virtualhostmatch) | Match a specific virtual host in a route configuration and apply the patch to the virtual host. |  |
| `name` | `string` | Route configuration name to match on. Can be used to match a specific route configuration by name, such as the internally generated "http_proxy" route configuration for all sidecars. |  |




---
### RouteMatch

 
Match a specific route inside a virtual host in a route configuration.

```yaml
"name": string
"action": .istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch.RouteMatch.Action

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `name` | `string` | The Route objects generated by default are named as "default". Route objects generated using a virtual service will carry the name used in the virtual service's HTTP routes. |  |
| `action` | [.istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch.RouteMatch.Action](../envoy_filter.proto.sk/#action) | Match a route with specific action type. |  |




---
### Action

 
Action refers to the route action taken by Envoy when a http route matches.

| Name | Description |
| ----- | ----------- | 
| `ANY` | All three route actions |
| `ROUTE` | Route traffic to a cluster / weighted clusters. |
| `REDIRECT` | Redirect request. |
| `DIRECT_RESPONSE` | directly respond to a request with specific payload. |




---
### VirtualHostMatch

 
Match a specific virtual host inside a route configuration.

```yaml
"name": string
"route": .istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch.RouteMatch

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `name` | `string` | The VirtualHosts objects generated by Istio are named as host:port, where the host typically corresponds to the VirtualService's host field or the hostname of a service in the registry. |  |
| `route` | [.istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch.RouteMatch](../envoy_filter.proto.sk/#routematch) | Match a specific route within the virtual host. |  |




---
### ListenerMatch

 
Conditions specified in a listener match must be met for the
patch to be applied to a specific listener across all filter
chains, or a specific filter chain inside the listener.

```yaml
"portNumber": int
"portName": string
"filterChain": .istio.networking.v1alpha3.EnvoyFilter.ListenerMatch.FilterChainMatch
"name": string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `portNumber` | `int` | The service port/gateway port to which traffic is being sent/received. If not specified, matches all listeners. Even though inbound listeners are generated for the instance/pod ports, only service ports should be used to match listeners. |  |
| `portName` | `string` | Instead of using specific port numbers, a set of ports matching a given service's port name can be selected. Matching is case insensitive. Not implemented. $hide_from_docs. |  |
| `filterChain` | [.istio.networking.v1alpha3.EnvoyFilter.ListenerMatch.FilterChainMatch](../envoy_filter.proto.sk/#filterchainmatch) | Match a specific filter chain in a listener. If specified, the patch will be applied to the filter chain (and a specific filter if specified) and not to other filter chains in the listener. |  |
| `name` | `string` | Match a specific listener by its name. The listeners generated by Pilot are typically named as IP:Port. |  |




---
### FilterChainMatch

 
For listeners with multiple filter chains (e.g., inbound
listeners on sidecars with permissive mTLS, gateway listeners
with multiple SNI matches), the filter chain match can be used
to select a specific filter chain to patch.

```yaml
"name": string
"sni": string
"transportProtocol": string
"applicationProtocols": string
"filter": .istio.networking.v1alpha3.EnvoyFilter.ListenerMatch.FilterMatch

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `name` | `string` | The name assigned to the filter chain. |  |
| `sni` | `string` | The SNI value used by a filter chain's match condition. This condition will evaluate to false if the filter chain has no sni match. |  |
| `transportProtocol` | `string` | Applies only to SIDECAR_INBOUND context. If non-empty, a transport protocol to consider when determining a filter chain match. This value will be compared against the transport protocol of a new connection, when it's detected by the tls_inspector listener filter. Accepted values include: * `raw_buffer` - default, used when no transport protocol is detected. * `tls` - set when TLS protocol is detected by the TLS inspector. |  |
| `applicationProtocols` | `string` | Applies only to sidecars. If non-empty, a comma separated set of application protocols to consider when determining a filter chain match. This value will be compared against the application protocols of a new connection, when it's detected by one of the listener filters such as the http_inspector. Accepted values include: h2,http/1.1,http/1.0. |  |
| `filter` | [.istio.networking.v1alpha3.EnvoyFilter.ListenerMatch.FilterMatch](../envoy_filter.proto.sk/#filtermatch) | The name of a specific filter to apply the patch to. Set this to envoy.http_connection_manager to add a filter or apply a patch to the HTTP connection manager. |  |




---
### FilterMatch

 
Conditions to match a specific filter within a filter chain.

```yaml
"name": string
"subFilter": .istio.networking.v1alpha3.EnvoyFilter.ListenerMatch.SubFilterMatch

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `name` | `string` | The filter name to match on. |  |
| `subFilter` | [.istio.networking.v1alpha3.EnvoyFilter.ListenerMatch.SubFilterMatch](../envoy_filter.proto.sk/#subfiltermatch) | The next level filter within this filter to match upon. Typically used for HTTP Connection Manager filters and Thrift filters. |  |




---
### SubFilterMatch

 
Conditions to match a specific filter within another
filter. This field is typically useful to match a HTTP filter
inside the envoy.http_connection_manager network filter. This
could also be applicable for thrift filters.

```yaml
"name": string

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `name` | `string` | The filter name to match on. |  |




---
### Patch

 
Patch specifies how the selected object should be modified.

```yaml
"operation": .istio.networking.v1alpha3.EnvoyFilter.Patch.Operation
"value": .google.protobuf.Struct

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `operation` | [.istio.networking.v1alpha3.EnvoyFilter.Patch.Operation](../envoy_filter.proto.sk/#operation) | Determines how the patch should be applied. |  |
| `value` | [.google.protobuf.Struct](https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/struct) | The JSON config of the object being patched. This will be merged using json merge semantics with the existing proto in the path. |  |




---
### Operation

 
Operation denotes how the patch should be applied to the selected
configuration.

| Name | Description |
| ----- | ----------- | 
| `INVALID` |  |
| `MERGE` | Merge the provided config with the generated config using json merge semantics. |
| `ADD` | Add the provided config to an existing list (of listeners, clusters, virtual hosts, network filters, or http filters). This operation will be ignored when applyTo is set to ROUTE_CONFIGURATION, or HTTP_ROUTE. |
| `REMOVE` | Remove the selected object from the list (of listeners, clusters, virtual hosts, network filters, or http filters). Does not require a value to be specified. This operation will be ignored when applyTo is set to ROUTE_CONFIGURATION, or HTTP_ROUTE. |
| `INSERT_BEFORE` | Insert operation on an array of named objects. This operation is typically useful only in the context of filters, where the order of filters matter. For clusters and virtual hosts, order of the element in the array does not matter. Insert before the selected filter or sub filter. If no filter is selected, the specified filter will be inserted at the front of the list. |
| `INSERT_AFTER` | Insert operation on an array of named objects. This operation is typically useful only in the context of filters, where the order of filters matter. For clusters and virtual hosts, order of the element in the array does not matter. Insert after the selected filter or sub filter. If no filter is selected, the specified filter will be inserted at the end of the list. |




---
### EnvoyConfigObjectMatch

 
One or more match conditions to be met before a patch is applied
to the generated configuration for a given proxy.

```yaml
"context": .istio.networking.v1alpha3.EnvoyFilter.PatchContext
"proxy": .istio.networking.v1alpha3.EnvoyFilter.ProxyMatch
"listener": .istio.networking.v1alpha3.EnvoyFilter.ListenerMatch
"routeConfiguration": .istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch
"cluster": .istio.networking.v1alpha3.EnvoyFilter.ClusterMatch

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `context` | [.istio.networking.v1alpha3.EnvoyFilter.PatchContext](../envoy_filter.proto.sk/#patchcontext) | The specific config generation context to match on. Istio Pilot generates envoy configuration in the context of a gateway, inbound traffic to sidecar and outbound traffic from sidecar. |  |
| `proxy` | [.istio.networking.v1alpha3.EnvoyFilter.ProxyMatch](../envoy_filter.proto.sk/#proxymatch) | Match on properties associated with a proxy. |  |
| `listener` | [.istio.networking.v1alpha3.EnvoyFilter.ListenerMatch](../envoy_filter.proto.sk/#listenermatch) | Match on envoy listener attributes. Only one of `listener`, or `cluster` can be set. |  |
| `routeConfiguration` | [.istio.networking.v1alpha3.EnvoyFilter.RouteConfigurationMatch](../envoy_filter.proto.sk/#routeconfigurationmatch) | Match on envoy HTTP route configuration attributes. Only one of `routeConfiguration`, or `cluster` can be set. |  |
| `cluster` | [.istio.networking.v1alpha3.EnvoyFilter.ClusterMatch](../envoy_filter.proto.sk/#clustermatch) | Match on envoy cluster attributes. Only one of `cluster`, or `routeConfiguration` can be set. |  |




---
### EnvoyConfigObjectPatch

 
Changes to be made to various envoy config objects.

```yaml
"applyTo": .istio.networking.v1alpha3.EnvoyFilter.ApplyTo
"match": .istio.networking.v1alpha3.EnvoyFilter.EnvoyConfigObjectMatch
"patch": .istio.networking.v1alpha3.EnvoyFilter.Patch

```

| Field | Type | Description | Default |
| ----- | ---- | ----------- |----------- | 
| `applyTo` | [.istio.networking.v1alpha3.EnvoyFilter.ApplyTo](../envoy_filter.proto.sk/#applyto) | Specifies where in the Envoy configuration, the patch should be applied. The match is expected to select the appropriate object based on applyTo. For example, an applyTo with HTTP_FILTER is expected to have a match condition on the listeners, with a network filter selection on envoy.http_connection_manager and a sub filter selection on the HTTP filter relative to which the insertion should be performed. Similarly, an applyTo on CLUSTER should have a match (if provided) on the cluster and not on a listener. |  |
| `match` | [.istio.networking.v1alpha3.EnvoyFilter.EnvoyConfigObjectMatch](../envoy_filter.proto.sk/#envoyconfigobjectmatch) | Match on listener/route configuration/cluster. |  |
| `patch` | [.istio.networking.v1alpha3.EnvoyFilter.Patch](../envoy_filter.proto.sk/#patch) | The patch to apply along with the operation. |  |




---
### ApplyTo

 
ApplyTo specifies where in the Envoy configuration, the given patch should be applied.

| Name | Description |
| ----- | ----------- | 
| `INVALID` |  |
| `LISTENER` | Applies the patch to the listener. |
| `FILTER_CHAIN` | Applies the patch to the filter chain. |
| `NETWORK_FILTER` | Applies the patch to the network filter chain, to modify an existing filter or add a new filter. |
| `HTTP_FILTER` | Applies the patch to the HTTP filter chain in the http connection manager, to modify an existing filter or add a new filter. |
| `ROUTE_CONFIGURATION` | Applies the patch to the Route configuration (rds output) inside a HTTP connection manager. This does not apply to the virtual host. Currently, only MERGE operation is allowed on the route configuration objects. |
| `VIRTUAL_HOST` | Applies the patch to a virtual host inside a route configuration. |
| `HTTP_ROUTE` | Applies the patch to a route object inside the matched virtual host in a route configuration. Currently, only MERGE operation is allowed on the route objects. |
| `CLUSTER` | Applies the patch to a cluster in a CDS output. Also used to add new clusters. |




---
### PatchContext

 
PatchContext selects a class of configurations based on the
traffic flow direction and workload type.

| Name | Description |
| ----- | ----------- | 
| `ANY` | All listeners/routes/clusters in both sidecars and gateways. |
| `SIDECAR_INBOUND` | Inbound listener/route/cluster in sidecar. |
| `SIDECAR_OUTBOUND` | Outbound listener/route/cluster in sidecar. |
| `GATEWAY` | Gateway listener/route/cluster. |





<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5130874.js"></script>
<!-- End of HubSpot Embed Code -->
